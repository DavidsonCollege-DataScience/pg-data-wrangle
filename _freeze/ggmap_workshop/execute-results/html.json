{
  "hash": "e5a2bdc087d188f5879c843dcecf42dd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Mapping Using ggplot\"\nformat: html\nexecute:\n  cache: true\n---\n\n\n\n\n## Intro\n\nThe `ggmap` package is a mapping library for R that is based on ggplot2. It allows data scientists to retrieve maps from a variety of sources like OSM, Google Maps, etc.\n\n![](https://raw.githubusercontent.com/dkahle/ggmap/refs/heads/master/tools/README-ggmap-patchwork-1.png){.preview-image fig-alt=\"ggmap package example\"}\n\n\n## Installation\n\nFirst, let's install some packages:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(tidyverse)) {\n  install.package(\"tidyverse\")\n}\n\nif (!require(maps)) {\n  install.package(\"maps\")\n}\n\nif (!require(educationdata)) {\n  install.packages(\"educationdata\")\n}\n```\n:::\n\n\n\n\nThese are the packages that we need. If you don't have them, the code will install them for you.\n\nIf you already have the packages, you can simply run:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(educationdata)\nlibrary(maps)\n```\n:::\n\n\n\n\n## Sample Dataset\n\nI will assume that you have merged the datasets and have access to the school metadata.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## CCD Data\nccd <- get_education_data(\n  level   = \"schools\",\n  source  = \"ccd\",\n  topic   = \"directory\",\n  filters = list(year = 2020)\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nFetching data for schools/ccd/directory/2020/? ...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 2 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 3 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 4 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 5 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 6 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 7 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 8 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 9 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 10 out of 11\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nProcessing page 11 out of 11\n```\n\n\n:::\n\n```{.r .cell-code}\nccd <- ccd %>%\n  filter(state_location == \"NC\")\n```\n:::\n\n\n\n\nBefore we start, let's look at the data a little bit. As we can see, we have so much information, and there are two columns that can pinpoint the location of each school.\n\nLet's focus on North Carolina data only:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nccd <- ccd %>%\n  filter(state_location == \"NC\")\n```\n:::\n\n\n\n\n## Mapping\n\nBefore we start, we need to fetch the information we need\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states <- map_data(\"state\")\nhead(us_states)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       long      lat group order  region subregion\n1 -87.46201 30.38968     1     1 alabama      <NA>\n2 -87.48493 30.37249     1     2 alabama      <NA>\n3 -87.52503 30.37249     1     3 alabama      <NA>\n4 -87.53076 30.33239     1     4 alabama      <NA>\n5 -87.57087 30.32665     1     5 alabama      <NA>\n6 -87.58806 30.32665     1     6 alabama      <NA>\n```\n\n\n:::\n:::\n\n\n\n\nThis is not the most useful thing, but we will plot all the states:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states %>%\n  ggplot() +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = region)) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](ggmap_workshop_files/figure-html/unnamed-chunk-5-1.png){width=768}\n:::\n:::\n\n\n\n\nNow, we can look at just one state:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states %>%\n  filter(region == \"north carolina\") %>%\n  ggplot() +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = region)) +\n  theme(legend.position = \"none\") +\n  labs(title = \"North Carolina\")\n```\n\n::: {.cell-output-display}\n![](ggmap_workshop_files/figure-html/unnamed-chunk-6-1.png){width=768}\n:::\n:::\n\n\n\n\n## Adding Information to Data\n\nWell, we have all seen the map. But, what if we want to plot where all the schools are? We can. Add we need to do is to add a layer with `geom_point` to include all schools:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states %>%\n  dplyr::filter(region == \"north carolina\") %>%\n  ggplot() +\n  geom_polygon(aes(x = long, y = lat,\n                   group = group, fill = region)) + \n  geom_point(data = ccd, aes(x = longitude, y = latitude)) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](ggmap_workshop_files/figure-html/unnamed-chunk-7-1.png){width=768}\n:::\n:::\n\n\n\n\nYou can also color the dots. For example, whether\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states %>%\n  dplyr::filter(region == \"north carolina\") %>%\n  ggplot() +\n  geom_polygon(aes(x = long, y = lat,\n                   group = group, fill = region)) + \n  geom_point(data = ccd, aes(x = longitude, y = latitude, color = as.character(charter)))\n```\n\n::: {.cell-output-display}\n![](ggmap_workshop_files/figure-html/unnamed-chunk-8-1.png){width=768}\n:::\n:::\n\n\n\n\nWhen you analyze your dataset, you will be more specific and maybe look at the outreach efforts of each college.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}